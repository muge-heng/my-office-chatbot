<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>AI聊天室 V4.1 - 星尘</title><script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script><script src="https://cdn.tailwindcss.com"></script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Orbitron:wght@400;500;700&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"><link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-tomorrow.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet"><link rel="stylesheet" href="284515e8d385f6792dcd.css"><script defer="defer" src="polyfill.js"></script><script defer="defer" src="taskpane.js"></script></head><body class="h-screen flex items-center justify-center p-0 overflow-hidden"><div id="appContainer" class="relative w-full h-full md:max-w-full md:h-full md:rounded-none overflow-hidden"><div id="chatPage" class="page flex flex-col w-full h-full"><header class="header flex justify-between items-center flex-shrink-0"><h1 class="text-xl md:text-2xl font-bold flex items-center"><i class="fas fa-satellite-dish mr-3 text-[var(--text-accent)] animate-pulseGlow" style="animation-duration:3s"></i> AI 星尘</h1><div class="flex items-center space-x-2 md:space-x-3"><button id="themeToggleButton" class="icon-button" title="切换主题 (暗/亮)"><i class="fas fa-sun"></i></button> <button id="settingsButton" class="icon-button" title="应用设置"><i class="fas fa-cogs"></i></button><div class="relative group"><button id="profileButton" class="flex items-center space-x-2 py-1 px-2 rounded-full hover:bg-[rgba(255,255,255,0.05)] transition duration-150"><img id="userAvatarHeader" src="https://placehold.co/36x36/82a9ff/0d0f1a?text=O&font=orbitron" alt="用户头像" class="w-8 h-8 rounded-full border-2 border-[var(--text-accent)] shadow-md group-hover:scale-105 transition-transform"> <span id="usernameHeader" class="text-sm font-semibold hidden md:inline text-[var(--text-primary-dark)]">Office User</span></button></div></div></header><div class="flex flex-grow overflow-hidden"><aside class="user-list-panel flex-shrink-0 overflow-y-auto transition-all duration-300 ease-in-out"><h2 class="text-lg font-semibold mb-5 pb-2 border-b-2"><i class="fas fa-users-cog mr-2"></i>在线频道</h2><ul id="userList" class="space-y-3"></ul></aside><main class="flex-grow flex flex-col transition-colors duration-300"><div id="messageArea" class="flex-grow overflow-y-auto space-y-5 scroll-smooth"><div class="text-center my-3"><span class="text-xs px-3 py-1.5 rounded-full bg-[var(--bg-accent)] text-[var(--text-secondary)] shadow-sm glassmorphism border-none">对话已准备就绪 | 开始与AI交流</span></div></div><div id="typingIndicator" class="h-7 px-6 pb-1 text-sm text-[var(--text-secondary)] italic flex items-center space-x-2"></div><div class="message-input-area flex items-center space-x-3 flex-shrink-0"><button id="stopGeneratingButton" class="btn btn-danger !p-2.5 !rounded-full" style="display:none"><i class="fas fa-stop text-lg"></i></button> <button id="getSelectionButton" class="icon-button text-xl p-3 rounded-full hover:bg-[var(--input-bg)] self-center" title="获取文档中选中的内容"><i class="fas fa-file-import"></i></button><div class="relative flex-grow"><textarea id="messageInput" placeholder="输入指令或信息 (Shift+Enter 换行)..." class="w-full focus:outline-none block" rows="1"></textarea> <button id="emojiButton" class="absolute icon-button text-xl p-2 rounded-full" title="表情符号"><i class="far fa-grin-beam"></i></button></div><button id="sendButton" class="btn btn-primary !rounded-xl self-stretch" disabled="disabled"><span class="hidden md:inline">发送</span> <i class="fas fa-paper-plane-top fas fa-location-arrow ml-0 md:ml-1.5"></i></button><div id="emojiPicker" class="emoji-picker hidden glassmorphism"></div></div></main></div></div><div id="settingsPage" class="page hidden overflow-y-auto"><div class="max-w-3xl mx-auto py-8 px-4 md:px-0"><div class="flex items-center justify-between mb-10"><h2 class="text-4xl font-bold"><i class="fas fa-atom mr-3 text-[var(--text-accent)]"></i>参数配置中心</h2><button id="closeSettingsButton" class="icon-button text-3xl" title="返回聊天"><i class="fas fa-times-circle opacity-70 hover:opacity-100"></i></button></div><div class="status-indicator fixed top-5 right-5 z-[100] glassmorphism !p-3 !rounded-xl" id="settingsStatusIndicator" style="display:none"></div><form id="apiSettingsForm" class="space-y-10"><div class="settings-section"><h3 class="settings-section-header"><i class="fas fa-network-wired"></i> AI 核心连接</h3><div class="api-provider grid grid-cols-2 md:grid-cols-4 gap-3 mb-6"><label class="flex items-center space-x-2 p-3 border border-[var(--border-accent)] rounded-lg cursor-pointer hover:bg-[var(--bg-accent)] has-[:checked]:bg-[var(--bg-accent)] has-[:checked]:border-[var(--text-accent)] has-[:checked]:shadow-lg"><input type="radio" name="apiProvider" value="deepseek" class="sr-only"> <i class="fas fa-brain provider-icon text-purple-400"></i> <span class="font-medium">DeepSeek</span></label> <label class="flex items-center space-x-2 p-3 border border-[var(--border-accent)] rounded-lg cursor-pointer hover:bg-[var(--bg-accent)] has-[:checked]:bg-[var(--bg-accent)] has-[:checked]:border-[var(--text-accent)] has-[:checked]:shadow-lg"><input type="radio" name="apiProvider" value="openai" class="sr-only"> <i class="fab fa-openai provider-icon text-teal-400"></i> <span class="font-medium">OpenAI</span></label> <label class="flex items-center space-x-2 p-3 border border-[var(--border-accent)] rounded-lg cursor-pointer hover:bg-[var(--bg-accent)] has-[:checked]:bg-[var(--bg-accent)] has-[:checked]:border-[var(--text-accent)] has-[:checked]:shadow-lg"><input type="radio" name="apiProvider" value="gemini" class="sr-only"> <svg class="provider-icon text-blue-400" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a10 10 0 100 20 10 10 0 000-20zm0 18a8 8 0 110-16 8 8 0 010 16zm-2.29-5.29L12 17.01l2.29-2.3a1 1 0 00-1.41-1.41L12 14.18l-.88-.88a1 1 0 10-1.41 1.41zM12 6.99l-2.29 2.3a1 1 0 101.41 1.41L12 9.82l.88.88a1 1 0 101.41-1.41L12 6.99z"/></svg> <span class="font-medium">Gemini</span></label> <label class="flex items-center space-x-2 p-3 border border-[var(--border-accent)] rounded-lg cursor-pointer hover:bg-[var(--bg-accent)] has-[:checked]:bg-[var(--bg-accent)] has-[:checked]:border-[var(--text-accent)] has-[:checked]:shadow-lg"><input type="radio" name="apiProvider" value="custom" class="sr-only"> <i class="fas fa-server provider-icon text-gray-400"></i> <span class="font-medium">自定义</span></label></div><div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5"><div class="form-group md:col-span-2"><label for="settingsApiKey"><i class="fas fa-key mr-1 opacity-70"></i> API 密钥 (机密)</label> <input type="password" id="settingsApiKey" placeholder="在此输入您的API密钥"></div><div class="form-group md:col-span-2" id="settingsApiUrlGroup" style="display:none"><label for="settingsApiUrl"><i class="fas fa-link mr-1 opacity-70"></i> API 端点地址</label> <input type="url" id="settingsApiUrl" placeholder="例如：https://your-proxy.com/v1"></div></div><div class="form-group md:col-span-2" id="settingsDefaultApiUrls"><label><i class="fas fa-info-circle mr-1 opacity-70"></i> 预设 API 地址</label><div class="mt-1 text-xs text-[var(--text-secondary)] p-3 bg-[var(--bg-accent)] rounded-md border border-[var(--border-color)]"><span id="settingsDeepseekUrl" class="block"><i class="fas fa-brain mr-1"></i> DeepSeek: https://api.deepseek.com/v1</span> <span id="settingsOpenaiUrl" style="display:none" class="block"><i class="fab fa-openai mr-1"></i> OpenAI: https://api.openai.com/v1</span> <span id="settingsGeminiUrl" style="display:none" class="block"><svg class="provider-icon text-blue-400 inline-block" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2a10 10 0 100 20 10 10 0 000-20zm0 18a8 8 0 110-16 8 8 0 010 16zm-2.29-5.29L12 17.01l2.29-2.3a1 1 0 00-1.41-1.41L12 14.18l-.88-.88a1 1 0 10-1.41 1.41zM12 6.99l-2.29 2.3a1 1 0 101.41 1.41L12 9.82l.88.88a1 1 0 101.41-1.41L12 6.99z"/></svg> Gemini: https://generativelanguage.googleapis.com/v1beta/models/</span></div></div><div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5 mt-4"><div class="form-group"><label for="settingsModelList"><i class="fas fa-microchip mr-1 opacity-70"></i> 可用模型 (逗号分隔)</label> <input id="settingsModelList" placeholder="deepseek-chat, gpt-4, gemini-1.5-flash-latest"></div><div class="form-group"><label for="settingsModelSelect"><i class="fas fa-check-circle mr-1 opacity-70"></i> 默认模型</label> <select id="settingsModelSelect"><option value="">-- 请先填入或获取模型 --</option></select></div></div><div class="form-group md:col-span-2 text-right mt-3"><button type="button" id="fetchModelsButton" class="btn btn-secondary text-sm py-2 px-4"><i class="fas fa-cloud-download-alt"></i> 自动获取模型</button></div><div class="streaming-option mt-3"><input type="checkbox" id="settingsStreamingEnabled" checked="checked" class="form-checkbox h-5 w-5 rounded"> <label for="settingsStreamingEnabled" class="ml-2 text-sm"><i class="fas fa-stream mr-1 opacity-70"></i> 启用流式输出 (实时显示)</label></div><div class="form-group mt-4" id="reasoningOptionContainer"><label class="text-sm"><i class="fas fa-project-diagram mr-1 opacity-70"></i> 高级选项</label><div class="streaming-option"><input type="checkbox" id="settingsReasoningEnabled" class="form-checkbox h-5 w-5 rounded"> <label for="settingsReasoningEnabled" class="ml-2 text-sm">启用推理模型 (若服务商支持)</label></div><p class="text-xs text-[var(--text-secondary)] mt-1">特定服务商（如DeepSeek）可能提供详细推理过程。</p></div></div><div class="settings-section" id="customApiSettingsSection" style="display:none"><h3 class="settings-section-header"><i class="fas fa-sliders-h"></i> 自定义 API 请求参数</h3><p class="text-sm text-[var(--text-secondary)] mb-4">为 "自定义" API Provider 添加额外的请求体参数。模型和消息列表会自动包含。</p><div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4 mb-4"><div class="form-group"><label for="customBodyKey">参数名 (Key)</label> <input id="customBodyKey" placeholder="例如：temperature"></div><div class="form-group"><label for="customBodyValue">参数值 (JSON)</label> <textarea id="customBodyValue" rows="2" placeholder='例如：0.7 或 {"max_tokens": 100}'></textarea></div></div><button type="button" id="addCustomBodyParamButton" class="btn btn-secondary text-sm py-2 px-4"><i class="fas fa-plus-circle"></i> 添加参数</button><div id="customBodyParamsList" class="mt-4 space-y-2"></div></div><div class="settings-section"><h3 class="settings-section-header"><i class="fas fa-palette"></i> AI 风格与个性化</h3><div class="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-5"><div class="form-group"><label for="aiStyleSelect"><i class="fas fa-paint-brush mr-1 opacity-70"></i> AI 回复风格</label> <select id="aiStyleSelect" class="w-full"><option value="default">默认 (平衡)</option><option value="professional">专业严谨</option><option value="friendly">友好亲切</option><option value="humorous">幽默风趣</option><option value="concise">简洁直接</option><option value="detailed">详细全面</option></select></div><div class="form-group"><label for="aiStyleStrength"><i class="fas fa-sliders-h mr-1 opacity-70"></i> 风格强度</label> <input type="range" id="aiStyleStrength" min="0.5" max="2" step="0.1" value="1" class="w-full h-2 bg-[var(--border-accent)] rounded-lg appearance-none cursor-pointer accent-[var(--text-accent)]"><div class="flex justify-between text-xs text-[var(--text-secondary)] mt-1"><span>柔和</span><span>适中</span><span>强烈</span></div></div><div class="form-group md:col-span-2"><label for="settingsUsernameInput"><i class="fas fa-user-astronaut mr-1 opacity-70"></i> 您的代号 (仅用于显示)</label> <input id="settingsUsernameInput" value="Office User" placeholder="星际探险家"></div></div></div><div class="settings-section"><h3 class="settings-section-header"><i class="fas fa-desktop"></i> 外观与管理</h3><div class="flex items-center justify-between mb-6 py-3 border-y border-[var(--border-accent)]"><span class="text-sm font-medium text-[var(--text-primary)] flex items-center"><i class="fas fa-adjust mr-2 opacity-70"></i> 主题模式 (暗/亮)</span> <label for="darkModeToggle" class="inline-flex relative items-center cursor-pointer"><input type="checkbox" value="" id="darkModeToggle" class="sr-only peer"><div class="w-11 h-6 peer-focus:outline-none peer-focus:ring-2 peer-focus:ring-[var(--input-focus-ring)] rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all"></div></label></div><div class="context-buttons grid grid-cols-2 gap-4"><button type="button" id="clearContextButton" class="btn btn-secondary w-full"><i class="fas fa-broom"></i> 清除当前对话上下文</button> <button type="button" id="clearChatButton" class="btn btn-danger w-full border-red-500/70 text-red-500 hover:bg-red-600 hover:text-white dark:hover:bg-red-700"><i class="fas fa-trash-alt"></i> 清空所有聊天记录</button></div><p class="text-xs text-[var(--text-secondary)] mt-3">"清除上下文"将开始新话题但保留记录，"清空记录"将删除所有本地存储的聊天记录。</p></div><div class="mt-12 text-center"><button type="submit" id="saveSettingsButton" class="btn btn-primary text-base py-3 px-8"><i class="fas fa-save"></i> 应用并保存配置</button></div></form></div></div><div id="toastNotification" class="fixed bottom-6 right-6 z-[200] text-white"></div></div><script src="https://cdn.jsdelivr.net/npm/marked@6.0.0/lib/marked.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.11/dist/purify.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/toolbar/prism-toolbar.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script><script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"></script><script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"></script><script src="68eb404b20789ad009ac.js"></script></body></html>